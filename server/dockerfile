# 使用 Node.js 镜像作为基础镜像
FROM node:16

# 设置工作目录
WORKDIR /app

# 复制依赖文件并安装依赖
COPY package*.json ./
RUN npm install

# 复制源代码
COPY . .

# 生成 Prisma 客户端
RUN npx prisma generate

# 安装 Python 和 pip
RUN apt-get update && apt-get install -y python3 python3-pip

# 复制并安装 Python 依赖
COPY requirements.txt ./
RUN pip3 install -r requirements.txt

# 暴露后端 API 服务端口
EXPOSE 5000

# 启动后端服务
CMD ["npm", "run", "dev"]

# 让应用监听的端口
EXPOSE 3001
